---
title: "网卡"
lastmod: "2022-12-04 15:55:54"
categories: ["Hardware"]
draft: true
---

## offload {#offload}

早先 TCP 设计的目标是为了解决低速网络传输的不可靠性问题（拨号上网的年代），但随着互联网骨干传输速度的提升（光纤、千兆以太、万兆以太）以及用户端更可靠的访问机制的出现（ADSL 等），相关的数据中心及客户端桌面环境上的 TCP 软件常常需要面临大量的计算需求。

当网络速度超过 1Gb 的时候，这些计算会耗费大量的 CPU 时间，有数据表明，即便使用千兆全双工网卡，TCP 通信也将消耗 CPU 的 80%的使用率（以 2.4GHz 奔腾 4 处理器为例），这样留给其他应用程序的时间就很少了，表现出来就是用户可能感觉到很慢。

为了解决性能问题，就产生了 TOE 技术（TCP offload engine），将 TCP 连接过程中的相关计算工作转移到专用硬件上（比如网卡），从而释放 CPU 资源。从 2012 年开始，这项技术开始在普通用户的网卡上应用。

随 着技术的日趋成熟，目前越来越多的网卡设备开始支持 offload 特性，以便提升网络收发和处理的性能。

offload 特性，主要是指将原本 在协议栈中进行的 IP 分片、TCP 分段、重组、checksum 校验等操作，转移到网卡硬件中进行，降低系统 CPU 的消耗，提高处理性能。